{{ define "connections" }}
{{ template "html-head" }}
{{ template "navbar" }}
<main>
{{ template "connections-content" . }}
</main>
{{ template "html-foot" }}
{{ end }}

{{ define "connections-content" }}
<p>Welcome to LogCrunch.</p>
<h2>SIEM Agents</h2>
<table>
    <tr>
        <th>Remote Address</th>
        <th>Hostname</th>
        <th>Alias</th>
        <th>Last Seen</th>
    </tr>
    {{ if . }}
    {{ range . }}
    <tr>
        <td>{{ .RemoteAddr }}</td>
        <td>{{ .Hostname }}</td>
        <td>
            {{ if .Alias }}
                <a href="/alias/edit?ip={{ .RemoteAddr }}">{{ .Alias }}</a>
            {{else}}<a href="/alias/edit?ip={{ .RemoteAddr }}">Edit</a>
            {{ end }}
        </td>
        <td>{{ .LastSeen }}</td>
    </tr>
    {{ end }}
    {{ end }}
</table>
<script src="/static/prettyConnectionTime.js"></script>
{{ end }}
